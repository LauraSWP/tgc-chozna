"use strict";(()=>{var e={};e.id=333,e.ids=[333],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},660:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>j,requestAsyncStorage:()=>y,routeModule:()=>x,serverHooks:()=>R,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{DELETE:()=>_,GET:()=>l,POST:()=>p,PUT:()=>m,dynamic:()=>c});var n=r(9303),o=r(8716),s=r(670),i=r(7070),u=r(5456),d=r(5370);let c="force-dynamic";async function l(e){try{let e=await (0,u.PR)();if(!e)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:t}=await (0,u.et)(e.id);if(t?.role!=="admin")return i.NextResponse.json({error:"Forbidden"},{status:403});let r=await (0,u.eI)(),{data:a,error:n}=await r.from("card_definitions").select(`
        *,
        rarities(code, display_name, color),
        card_sets(code, name)
      `).order("created_at",{ascending:!1});if(n)throw n;return i.NextResponse.json({cards:a})}catch(e){return console.error("Error fetching cards:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function p(e){try{let t=await (0,u.PR)();if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:r}=await (0,u.et)(t.id);if(r?.role!=="admin")return i.NextResponse.json({error:"Forbidden"},{status:403});let a=await e.json(),n=(0,d.b0)(d.Wj,a);if(!n.success)return i.NextResponse.json({error:n.error},{status:400});let o=await (0,u.eI)(),{data:s,error:c}=await o.from("card_definitions").insert(n.data).select().single();if(c)throw c;return i.NextResponse.json({card:s})}catch(e){return console.error("Error creating card:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function m(e){try{let t=await (0,u.PR)();if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:r}=await (0,u.et)(t.id);if(r?.role!=="admin")return i.NextResponse.json({error:"Forbidden"},{status:403});let{id:a,...n}=await e.json();if(!a)return i.NextResponse.json({error:"Card ID required"},{status:400});let o=await (0,u.eI)(),{data:s,error:d}=await o.from("card_definitions").update(n).eq("id",a).select().single();if(d)throw d;return i.NextResponse.json({card:s})}catch(e){return console.error("Error updating card:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function _(e){try{let t=await (0,u.PR)();if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:r}=await (0,u.et)(t.id);if(r?.role!=="admin")return i.NextResponse.json({error:"Forbidden"},{status:403});let{searchParams:a}=new URL(e.url),n=a.get("id");if(!n)return i.NextResponse.json({error:"Card ID required"},{status:400});let o=await (0,u.eI)(),{error:s}=await o.from("card_definitions").delete().eq("id",n);if(s)throw s;return i.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting card:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let x=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/cards/route",pathname:"/api/admin/cards",filename:"route",bundlePath:"app/api/admin/cards/route"},resolvedPagePath:"C:\\Users\\bkgum\\OneDrive\\Documents\\PythonScripts\\TGC\\tgc-chozna\\src\\app\\api\\admin\\cards\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:R}=x,g="/api/admin/cards/route";function j(){return(0,s.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:f})}},5456:(e,t,r)=>{r.d(t,{PR:()=>s,eI:()=>o,et:()=>i});var a=r(6718),n=r(1615);async function o(){let e=(0,n.cookies)();return(0,a.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:t=>e.get(t)?.value}})}async function s(){let e=await o(),{data:{user:t}}=await e.auth.getUser();return t}async function i(e){let t=await o(),{data:r,error:a}=await t.from("profiles").select("*").eq("id",e).single();return{data:r,error:a}}},5370:(e,t,r)=>{r.d(t,{Wj:()=>i,b0:()=>u,pn:()=>s});var a=r(1585),n=r(6033);let o=a.Ry({name:a.Z_().min(1).max(100),type_line:a.Z_().min(1).max(100),mana_cost:a.Z_().optional(),power:a.Rx().int().min(0).max(99).optional(),toughness:a.Rx().int().min(0).max(99).optional(),keywords:a.IX(a.Z_()).default([]),rules_json:a.Ry({on_play:a.IX(a.Yj()).optional(),on_enter:a.IX(a.Yj()).optional(),on_leave:a.IX(a.Yj()).optional(),activated:a.IX(a.Yj()).optional(),triggers:a.IX(a.Yj()).optional()}).default({}),flavor_text:a.Z_().optional(),artist:a.Z_().optional(),image_url:a.Z_().url().optional()});a.Ry({name:a.Z_().min(1).max(100),description:a.Z_().max(500).optional(),format:a.Z_().default("casual")});let s=a.Ry({set_code:a.Z_().min(1),quantity:a.Rx().int().min(1).max(10).default(1)});a.Ry({target_user_id:a.Z_().uuid(),offered_cards:a.IX(a.Z_()).min(1),requested_cards:a.IX(a.Z_()).min(1),message:a.Z_().max(500).optional()}),a.VK("type",[a.Ry({type:a.i0("play_card"),card_id:a.Z_(),target:a.Z_().optional()}),a.Ry({type:a.i0("activate_ability"),source_id:a.Z_(),ability_index:a.Rx().int().min(0),target:a.Z_().optional()}),a.Ry({type:a.i0("attack"),attackers:a.IX(a.Z_()).min(1),targets:a.IX(a.Z_()).optional()}),a.Ry({type:a.i0("block"),blocks:a.IX(a.Ry({attacker:a.Z_(),blocker:a.Z_()}))}),a.Ry({type:a.i0("pass_priority")}),a.Ry({type:a.i0("pass_turn")}),a.Ry({type:a.i0("mulligan")}),a.Ry({type:a.i0("concede")})]),a.Ry({email:a.Z_().email(),password:a.Z_().min(8).max(128),username:a.Z_().min(3).max(30).regex(/^[a-zA-Z0-9_]+$/)}),a.Ry({username:a.Z_().min(3).max(30).regex(/^[a-zA-Z0-9_]+$/).optional(),avatar_url:a.Z_().url().optional()});let i=o.extend({set_id:a.Z_().uuid(),rarity_id:a.Rx().int().min(1),external_code:a.Z_().optional()});function u(e,t){try{let r=e.parse(t);return{success:!0,data:r}}catch(e){if(e instanceof n.jm)return{success:!1,error:e.errors.map(e=>`${e.path.join(".")}: ${e.message}`).join(", ")};return{success:!1,error:"Validation failed"}}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,305,972,585],()=>r(660));module.exports=a})();