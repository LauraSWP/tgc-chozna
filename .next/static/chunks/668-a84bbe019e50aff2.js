"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{7668:function(e,a,t){t.d(a,{default:function(){return x}});var r=t(7437),s=t(2265),l=t(9376),i=t(2381),n=t(9820),o=t(6634),d=t(7119);let c=d.Ry({name:d.Z_().min(1).max(100),type_line:d.Z_().min(1).max(100),mana_cost:d.Z_().optional(),power:d.Rx().int().min(0).max(99).optional(),toughness:d.Rx().int().min(0).max(99).optional(),keywords:d.IX(d.Z_()).default([]),rules_json:d.Ry({on_play:d.IX(d.Yj()).optional(),on_enter:d.IX(d.Yj()).optional(),on_leave:d.IX(d.Yj()).optional(),activated:d.IX(d.Yj()).optional(),triggers:d.IX(d.Yj()).optional()}).default({}),flavor_text:d.Z_().optional(),artist:d.Z_().optional(),image_url:d.Z_().url().optional()});d.Ry({name:d.Z_().min(1).max(100),description:d.Z_().max(500).optional(),format:d.Z_().default("casual")}),d.Ry({set_code:d.Z_().min(1),quantity:d.Rx().int().min(1).max(10).default(1)}),d.Ry({target_user_id:d.Z_().uuid(),offered_cards:d.IX(d.Z_()).min(1),requested_cards:d.IX(d.Z_()).min(1),message:d.Z_().max(500).optional()}),d.VK("type",[d.Ry({type:d.i0("play_card"),card_id:d.Z_(),target:d.Z_().optional()}),d.Ry({type:d.i0("activate_ability"),source_id:d.Z_(),ability_index:d.Rx().int().min(0),target:d.Z_().optional()}),d.Ry({type:d.i0("attack"),attackers:d.IX(d.Z_()).min(1),targets:d.IX(d.Z_()).optional()}),d.Ry({type:d.i0("block"),blocks:d.IX(d.Ry({attacker:d.Z_(),blocker:d.Z_()}))}),d.Ry({type:d.i0("pass_priority")}),d.Ry({type:d.i0("pass_turn")}),d.Ry({type:d.i0("mulligan")}),d.Ry({type:d.i0("concede")})]),d.Ry({email:d.Z_().email(),password:d.Z_().min(8).max(128),username:d.Z_().min(3).max(30).regex(/^[a-zA-Z0-9_]+$/)}),d.Ry({username:d.Z_().min(3).max(30).regex(/^[a-zA-Z0-9_]+$/).optional(),avatar_url:d.Z_().url().optional()}),c.extend({set_id:d.Z_().uuid(),rarity_id:d.Rx().int().min(1),external_code:d.Z_().optional()});var m=t(3448),u=e=>{let{card:a,frameStyle:t="classic",imageUrl:s,className:l}=e;(0,m.ew)(a.manaCost||"");let i=a.manaCost&&a.manaCost.match(/\{[^}]+\}/g)||[],n=(0,m.kg)(a.rarity||"common"),o={classic:"bg-gradient-to-b from-yellow-50 to-yellow-100 border-yellow-400",modern:"bg-gradient-to-br from-gray-50 to-blue-50 border-blue-400",vintage:"bg-gradient-to-b from-amber-50 to-amber-100 border-amber-600",digital:"bg-gradient-to-br from-cyan-50 to-purple-50 border-cyan-400",mystical:"bg-gradient-to-b from-purple-50 to-pink-50 border-purple-400",industrial:"bg-gradient-to-br from-gray-100 to-slate-100 border-slate-400"},d=o[t]||o.classic;return(0,r.jsxs)("div",{className:(0,m.cn)("relative w-48 h-64 rounded-lg border-2 shadow-lg overflow-hidden",d,l),children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 right-0 p-2 bg-black/10",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)("div",{className:"flex-1 pr-2",children:(0,r.jsx)("h3",{className:"text-sm font-bold text-gray-900 leading-tight",children:a.name||"Card Name"})}),i.length>0&&(0,r.jsx)("div",{className:"flex gap-0.5 flex-shrink-0",children:i.map((e,a)=>(0,r.jsx)("div",{className:"w-4 h-4 rounded-full bg-gray-200 border border-gray-400 flex items-center justify-center text-xs font-bold",children:e.replace(/[{}]/g,"")},a))})]})}),(0,r.jsx)("div",{className:"absolute top-8 left-2 right-2 h-24 bg-gray-200 rounded border overflow-hidden",children:s?(0,r.jsx)("img",{src:s,alt:a.name||"Card image",className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-1",children:"\uD83D\uDDBC️"}),(0,r.jsx)("div",{className:"text-xs",children:"No Image"})]})})}),(0,r.jsx)("div",{className:"absolute top-36 left-2 right-2 p-1 bg-white/80 rounded border text-center",children:(0,r.jsx)("div",{className:"text-xs font-semibold text-gray-800",children:a.typeLine||"Card Type"})}),(0,r.jsx)("div",{className:"absolute top-44 left-2 right-2 bottom-12 p-2 bg-white/80 rounded border overflow-hidden",children:(0,r.jsxs)("div",{className:"text-xs text-gray-800 leading-tight",children:[a.keywords&&a.keywords.length>0&&(0,r.jsx)("div",{className:"font-semibold mb-1",children:a.keywords.join(", ")}),a.flavorText&&(0,r.jsxs)("div",{className:"italic text-gray-600 text-xs",children:['"',a.flavorText,'"']})]})}),void 0!==a.power&&void 0!==a.toughness&&(0,r.jsx)("div",{className:"absolute bottom-2 right-2 w-8 h-6 bg-white rounded border border-gray-400 flex items-center justify-center",children:(0,r.jsxs)("span",{className:"text-xs font-bold",children:[a.power,"/",a.toughness]})}),(0,r.jsx)("div",{className:"absolute bottom-2 left-2 w-4 h-4 rounded-full border-2 border-white",style:{backgroundColor:n},title:"".concat(a.rarity," rarity")}),(0,r.jsx)("div",{className:"absolute top-1 right-1 px-1 py-0.5 bg-black/60 text-white text-xs rounded",children:t}),(0,r.jsx)("div",{className:"absolute bottom-8 right-2 w-4 h-4 bg-gray-400 rounded-full flex items-center justify-center text-xs text-white font-bold",children:"S"})]})},x=e=>{var a,t,d,c,m,x,p,g;let{cardId:b,onSave:h,onCancel:y}=e,f=(0,l.useRouter)(),[v,j]=(0,s.useState)({external_code:"",name:"",type_line:"",mana_cost:"",power:null,toughness:null,keywords:[],rules_json:{},flavor_text:"",artist:"",rarity_id:1,set_id:"",is_active:!0,image_url:"",frame_style:"classic"}),[N,_]=(0,s.useState)([]),[D,w]=(0,s.useState)([]),[C,k]=(0,s.useState)([]),[S,A]=(0,s.useState)(!1),[R,E]=(0,s.useState)(""),[z,Z]=(0,s.useState)("{}"),[I,O]=(0,s.useState)(null),[B,T]=(0,s.useState)(""),[F,q]=(0,s.useState)(!1),[P,U]=(0,s.useState)([]);(0,s.useEffect)(()=>{M(),b&&Q()},[b]),(0,s.useEffect)(()=>{v.mana_cost&&U((v.mana_cost.match(/\{[^}]+\}/g)||[]).map(e=>e.slice(1,-1)))},[v.mana_cost]);let X=e=>{let a=[...P,e];U(a),j(e=>({...e,mana_cost:a.map(e=>"{".concat(e,"}")).join("")}))},L=e=>{let a=P.filter((a,t)=>t!==e);U(a),j(e=>({...e,mana_cost:a.map(e=>"{".concat(e,"}")).join("")}))},M=async()=>{try{let[e,a]=await Promise.all([o.OQ.from("rarities").select("*").order("id"),o.OQ.from("card_sets").select("*").order("name")]);e.data&&_(e.data),a.data&&w(a.data)}catch(e){console.error("Error loading reference data:",e)}},Q=async()=>{if(b)try{let{data:a,error:t}=await o.OQ.from("card_definitions").select("*").eq("id",b).single();if(t)throw t;if(a){var e;j({external_code:a.external_code||"",name:a.name||"",type_line:a.type_line||"",mana_cost:a.mana_cost||"",power:a.power,toughness:a.toughness,keywords:a.keywords||[],rules_json:a.rules_json||{},flavor_text:a.flavor_text||"",artist:a.artist||"",rarity_id:a.rarity_id||1,set_id:a.set_id||"",is_active:null===(e=a.is_active)||void 0===e||e,image_url:a.image_url||"",frame_style:a.frame_style||"classic"}),Z(JSON.stringify(a.rules_json||{},null,2))}}catch(e){console.error("Error loading card:",e),k(["Failed to load card"])}},J=async()=>{A(!0),k([]);try{var e;let a=[];v.name.trim()||a.push("Name is required"),v.type_line.trim()||a.push("Type line is required"),v.mana_cost&&!(!(e=v.mana_cost)||/^(\{[0-9WUBRGCX]\})*$/.test(e))&&a.push("Invalid mana cost format");let t={};try{t=JSON.parse(z);let e=function(e){let a=[];try{e.on_play&&!Array.isArray(e.on_play)&&a.push("on_play must be an array"),e.on_enter&&!Array.isArray(e.on_enter)&&a.push("on_enter must be an array"),e.activated&&!Array.isArray(e.activated)&&a.push("activated must be an array"),e.triggers&&!Array.isArray(e.triggers)&&a.push("triggers must be an array");let t=e=>{e.forEach((e,t)=>{switch(e.op||a.push("Effect ".concat(t," missing operation type")),e.op){case"draw":("number"!=typeof e.count||e.count<1)&&a.push("Draw effect ".concat(t," needs positive count"));break;case"damage":("number"!=typeof e.amount||e.amount<0)&&a.push("Damage effect ".concat(t," needs non-negative amount"));break;case"buff":case"debuff":e.selector||a.push("Buff/Debuff effect ".concat(t," needs selector"))}})};e.on_play&&t(e.on_play),e.on_enter&&t(e.on_enter)}catch(e){a.push("Invalid rules structure")}return{valid:0===a.length,errors:a}}(t);e.valid||a.push(...e.errors)}catch(e){a.push("Invalid rules JSON")}if(a.length>0){k(a),A(!1);return}let r={...v,rules_json:t,power:v.power||null,toughness:v.toughness||null};if(b){let{error:e}=await o.OQ.from("card_definitions").update(r).eq("id",b);if(e)throw e}else{let{error:e}=await o.OQ.from("card_definitions").insert(r);if(e)throw e}h?h(r):f.push("/admin/cards")}catch(e){console.error("Error saving card:",e),k([e.message||"Failed to save card"])}finally{A(!1)}},V=()=>{R.trim()&&!v.keywords.includes(R.trim())&&(j(e=>({...e,keywords:[...e.keywords,R.trim()]})),E(""))},H=e=>{j(a=>({...a,keywords:a.keywords.filter(a=>a!==e)}))},Y=e=>{let a={};switch(e){case"draw":a={op:"draw",count:1,target:"self"};break;case"damage":a={op:"damage",amount:1,target:"any"};break;case"buff":a={op:"buff",power:1,toughness:1,until:"end_of_turn",selector:"self"};break;case"destroy":a={op:"destroy",selector:"target_creature"}}try{let e=JSON.parse(z);e.on_play||(e.on_play=[]),e.on_play.push(a),Z(JSON.stringify(e,null,2))}catch(e){Z(JSON.stringify({on_play:[a]},null,2))}},G=async e=>{q(!0);try{let a=e.name.split(".").pop(),t="".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9),".").concat(a),{data:r,error:s}=await o.OQ.storage.from("card-images").upload(t,e);if(s)throw s;let{data:{publicUrl:l}}=o.OQ.storage.from("card-images").getPublicUrl(t);j(e=>({...e,image_url:l})),T(l)}catch(e){console.error("Error uploading image:",e),k(e=>[...e,"Failed to upload image"])}finally{q(!1)}},$=[{value:"classic",label:"Cl\xe1sico",preview:"\uD83D\uDDBC️ Marco tradicional de carta"},{value:"modern",label:"Moderno",preview:"✨ Dise\xf1o moderno y elegante"},{value:"vintage",label:"Vintage",preview:"\uD83D\uDCDC Estilo retro"},{value:"digital",label:"Digital",preview:"\uD83D\uDCBE Tema cibern\xe9tico"},{value:"mystical",label:"M\xedstico",preview:"\uD83C\uDF1F Efectos m\xe1gicos"},{value:"industrial",label:"Industrial",preview:"⚙️ Tema tecnol\xf3gico/metal"}],K=[{symbol:"0",color:"bg-gray-300",label:"Cero"},{symbol:"1",color:"bg-gray-300",label:"Uno"},{symbol:"2",color:"bg-gray-300",label:"Dos"},{symbol:"3",color:"bg-gray-300",label:"Tres"},{symbol:"4",color:"bg-gray-300",label:"Cuatro"},{symbol:"5",color:"bg-gray-300",label:"Cinco"},{symbol:"6",color:"bg-gray-300",label:"Seis"},{symbol:"X",color:"bg-gray-400",label:"Variable"},{symbol:"W",color:"bg-yellow-200",label:"Blanco"},{symbol:"U",color:"bg-blue-200",label:"Azul"},{symbol:"B",color:"bg-gray-800",label:"Negro"},{symbol:"R",color:"bg-red-200",label:"Rojo"},{symbol:"G",color:"bg-green-200",label:"Verde"},{symbol:"C",color:"bg-gray-200",label:"Incoloro"}],W=e=>{switch(e){case"common":return"~66% de sobres (10/15 cartas)";case"uncommon":return"~20% de sobres (3/15 cartas)";case"rare":case"land":return"~7% de sobres (1/15 cartas)";case"mythic":return"~0.9% de sobres (1/8 espacios raros)";case"token":return"Solo fichas especiales";default:return"Desconocido"}};return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[(0,r.jsx)(n.ll,{className:"text-2xl",children:b?"✏️ Editar Carta":"\uD83C\uDD95 Crear Nueva Carta"}),(0,r.jsx)(n.SZ,{className:"text-lg",children:b?"Modifica una carta existente":"Crea una nueva carta para el juego"})]}),(0,r.jsxs)(n.aY,{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:"\uD83C\uDFA8 Vista Previa de la Carta"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:["\uD83D\uDDBC️ Imagen de la Carta",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Esta ser\xe1 la imagen principal de tu carta)"})]}),(0,r.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center bg-gray-50",children:B||v.image_url?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("img",{src:B||v.image_url,alt:"Vista previa de carta",className:"w-full h-64 object-cover rounded-lg shadow-lg"}),(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{T(""),O(null),j(e=>({...e,image_url:""}))},children:"\uD83D\uDDD1️ Quitar Imagen"})]}):(0,r.jsxs)("div",{className:"space-y-4 py-8",children:[(0,r.jsx)("div",{className:"text-gray-400 text-6xl",children:"\uD83D\uDDBC️"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-600",children:"No hay imagen seleccionada"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Sube una imagen para ver c\xf3mo quedar\xe1 tu carta"})]})]})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(t){O(t);let e=new FileReader;e.onload=()=>{T(e.result)},e.readAsDataURL(t)}},className:"w-full text-sm border rounded-md px-3 py-2",id:"image-upload"}),I&&(0,r.jsx)(i.z,{type:"button",onClick:()=>G(I),disabled:F,size:"sm",children:F?"⬆️ Subiendo...":"⬆️ Subir"})]}),(0,r.jsx)("div",{className:"text-center text-xs text-gray-500",children:"O pega una URL de imagen aqu\xed abajo"}),(0,r.jsx)("input",{type:"url",value:v.image_url,onChange:e=>j(a=>({...a,image_url:e.target.value})),className:"w-full border rounded-md px-3 py-2 text-sm",placeholder:"https://ejemplo.com/imagen.jpg"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:["\uD83D\uDDBC️ Estilo del Marco",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Cambia el dise\xf1o del borde de la carta)"})]}),(0,r.jsx)("select",{value:v.frame_style,onChange:e=>j(a=>({...a,frame_style:e.target.value})),className:"w-full border rounded-md px-3 py-2",children:$.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:null===(a=$.find(e=>e.value===v.frame_style))||void 0===a?void 0:a.preview})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:["⚡ Vista Previa en Vivo",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(As\xed se ver\xe1 tu carta en el juego)"})]}),(0,r.jsx)("div",{className:"flex justify-center bg-gradient-to-br from-blue-50 to-purple-50 p-4 rounded-lg",children:(0,r.jsx)(u,{card:{name:v.name||"Nombre de la Carta",typeLine:v.type_line||"Tipo — Subtipo",manaCost:v.mana_cost,power:null!==(p=v.power)&&void 0!==p?p:void 0,toughness:null!==(g=v.toughness)&&void 0!==g?g:void 0,keywords:v.keywords,flavorText:v.flavor_text,rarity:(null===(t=N.find(e=>e.id===v.rarity_id))||void 0===t?void 0:t.code)||"common"},frameStyle:v.frame_style,imageUrl:B||v.image_url,className:"scale-90"})})]})]})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:"\uD83D\uDCDD Detalles de la Carta"}),(0,r.jsxs)("div",{className:"space-y-6 bg-white p-6 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:"ℹ️ Informaci\xf3n B\xe1sica"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["\uD83C\uDFF7️ C\xf3digo Externo",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Identificador \xfanico, ej: BAS001)"})]}),(0,r.jsx)("input",{type:"text",value:v.external_code,onChange:e=>j(a=>({...a,external_code:e.target.value})),className:"w-full border rounded-md px-3 py-2",placeholder:"BAS001"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["\uD83D\uDCDB Nombre de la Carta *",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(El nombre que aparecer\xe1 en la carta)"})]}),(0,r.jsx)("input",{type:"text",value:v.name,onChange:e=>j(a=>({...a,name:e.target.value})),className:"w-full border rounded-md px-3 py-2",placeholder:"Desarrollador Cafetero",required:!0})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["\uD83C\uDFAD L\xednea de Tipo *",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Qu\xe9 tipo de carta es, ej: Criatura — Humano Desarrollador)"})]}),(0,r.jsx)("input",{type:"text",value:v.type_line,onChange:e=>j(a=>({...a,type_line:e.target.value})),className:"w-full border rounded-md px-3 py-2",placeholder:"Criatura — Humano Desarrollador",required:!0})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg border",children:[(0,r.jsxs)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:["⚡ Constructor de Coste de Man\xe1",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Haz clic en los s\xedmbolos para a\xf1adir man\xe1)"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-md border",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Coste Actual:"}),(0,r.jsx)("div",{className:"flex items-center gap-2 flex-wrap min-h-10",children:P.length>0?(0,r.jsxs)(r.Fragment,{children:[P.map((e,a)=>{var t;return(0,r.jsx)("button",{type:"button",onClick:()=>L(a),className:"w-8 h-8 rounded-full border-2 border-gray-400 text-sm font-bold flex items-center justify-center hover:bg-red-100 transition-colors ".concat((null===(t=K.find(a=>a.symbol===e))||void 0===t?void 0:t.color)||"bg-gray-300"," ").concat("B"===e?"text-white":"text-black"),title:"Clic para quitar ".concat(e),children:e},a)}),(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{U([]),j(e=>({...e,mana_cost:""}))},children:"\uD83D\uDDD1️ Limpiar"})]}):(0,r.jsx)("span",{className:"text-gray-500 italic",children:"Sin coste de man\xe1"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"S\xedmbolos de Man\xe1 Disponibles:"}),(0,r.jsx)("div",{className:"grid grid-cols-7 md:grid-cols-14 gap-2",children:K.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>X(e.symbol),className:"w-10 h-10 rounded-full border-2 border-gray-400 text-sm font-bold flex items-center justify-center hover:scale-110 transition-transform ".concat(e.color," ").concat("B"===e.symbol?"text-white":"text-black"),title:"A\xf1adir ".concat(e.label),children:e.symbol},e.symbol))}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"\uD83D\uDCA1 Tip: Los n\xfameros representan man\xe1 incoloro, las letras representan colores espec\xedficos"})]})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-orange-50 p-6 rounded-lg border",children:[(0,r.jsxs)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:["\uD83D\uDCAA Estad\xedsticas de Criatura",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Solo para criaturas)"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["⚔️ Poder",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Da\xf1o que hace al atacar)"})]}),(0,r.jsx)("input",{type:"number",value:v.power||"",onChange:e=>j(a=>({...a,power:e.target.value?parseInt(e.target.value):null})),className:"w-full border rounded-md px-3 py-2",min:"0",max:"99",placeholder:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["\uD83D\uDEE1️ Resistencia",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Da\xf1o que puede recibir antes de morir)"})]}),(0,r.jsx)("input",{type:"number",value:v.toughness||"",onChange:e=>j(a=>({...a,toughness:e.target.value?parseInt(e.target.value):null})),className:"w-full border rounded-md px-3 py-2",min:"0",max:"99",placeholder:"0"})]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 bg-white p-3 rounded border",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Tip:"})," Solo rellena estos campos si tu carta es una criatura. Las cartas de hechizo, encantamiento, etc. no necesitan poder y resistencia."]})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-purple-50 p-6 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDC8E Rareza y Colecci\xf3n"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["⭐ Rareza de la Carta *",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Qu\xe9 tan rara es en los sobres)"})]}),(0,r.jsx)("select",{value:v.rarity_id,onChange:e=>j(a=>({...a,rarity_id:parseInt(e.target.value)})),className:"w-full border rounded-md px-3 py-2",required:!0,children:N.map(e=>(0,r.jsx)("option",{value:e.id,children:e.display_name},e.id))}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["\uD83D\uDCCA Probabilidad: ",W(null===(d=N.find(e=>e.id===v.rarity_id))||void 0===d?void 0:d.code)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["\uD83D\uDCDA Colecci\xf3n *",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(A qu\xe9 set pertenece esta carta)"})]}),(0,r.jsxs)("select",{value:v.set_id,onChange:e=>j(a=>({...a,set_id:e.target.value})),className:"w-full border rounded-md px-3 py-2",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Selecciona una colecci\xf3n"}),D.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.code,")"]},e.id))]})]})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-green-50 p-6 rounded-lg border",children:[(0,r.jsxs)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:["\uD83C\uDFF7️ Palabras Clave",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Habilidades especiales de la carta)"})]}),(0,r.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,r.jsx)("input",{type:"text",value:R,onChange:e=>E(e.target.value),className:"flex-1 border rounded-md px-3 py-2",placeholder:"volar, prisa, vigilancia, etc.",onKeyPress:e=>"Enter"===e.key&&V()}),(0,r.jsx)(i.z,{onClick:V,type:"button",variant:"outline",children:"➕ A\xf1adir"})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:v.keywords.map(e=>(0,r.jsxs)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm flex items-center gap-1",children:[e,(0,r.jsx)("button",{onClick:()=>H(e),className:"text-blue-600 hover:text-blue-800",children:"\xd7"})]},e))}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 bg-white p-3 rounded border",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Tip:"}),' Las palabras clave son habilidades especiales como "volar" (no puede ser bloqueada), "prisa" (puede atacar inmediatamente), etc.']})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-red-50 p-6 rounded-lg border",children:[(0,r.jsxs)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:["⚡ Efectos de la Carta",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Qu\xe9 hace la carta cuando se juega)"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h5",{className:"text-sm font-medium mb-2",children:"\uD83D\uDE80 Plantillas de Efectos R\xe1pidos"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{name:"Robar Cartas",description:"Roba cartas al jugarse",template:{on_play:[{op:"draw",count:1,target:"self"}]}},{name:"Da\xf1o Directo",description:"Hace da\xf1o a cualquier objetivo",template:{on_play:[{op:"damage",amount:2,target:"any"}]}},{name:"Potenciar Criatura",description:"Mejora las estad\xedsticas de criatura",template:{on_play:[{op:"buff",power:1,toughness:1,until:"end_of_turn",selector:"target_creature"}]}},{name:"Destruir",description:"Destruye permanente objetivo",template:{on_play:[{op:"destroy",selector:"target_creature"}]}},{name:"Al Entrar",description:"Efecto cuando la criatura entra",template:{on_enter:[{op:"draw",count:1,target:"self"}]}},{name:"Habilidad Activada",description:"Paga un coste para activar",template:{activated:[{cost:"{1}, {T}",effects:[{op:"draw",count:1,target:"self"}]}]}},{name:"Al Morir",description:"Efecto cuando muere",template:{on_death:[{op:"damage",amount:2,target:"any"}]}},{name:"Generar Man\xe1",description:"A\xf1ade man\xe1 al pool",template:{activated:[{cost:"{T}",effects:[{op:"gain_mana",colors:["C"],amount:1}]}]}}].map((e,a)=>(0,r.jsxs)(i.z,{type:"button",variant:"outline",size:"sm",className:"h-auto p-2 flex flex-col items-center text-center",onClick:()=>Z(JSON.stringify(e.template,null,2)),title:e.description,children:[(0,r.jsx)("span",{className:"text-xs font-medium",children:e.name}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:e.description})]},a))})]}),(0,r.jsxs)("div",{className:"mb-2 flex flex-wrap gap-2",children:[(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>Y("draw"),children:"+ Robar Cartas"}),(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>Y("damage"),children:"+ Hacer Da\xf1o"}),(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>Y("buff"),children:"+ Potenciar Criatura"}),(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>Y("destroy"),children:"+ Destruir"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"\uD83D\uDD27 Editor JSON Avanzado"}),(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{try{let e=JSON.parse(z);Z(JSON.stringify(e,null,2))}catch(e){}},children:"\uD83D\uDCD0 Formatear JSON"})]}),(0,r.jsx)("textarea",{value:z,onChange:e=>Z(e.target.value),className:"w-full border rounded-md px-3 py-2 font-mono text-sm h-32",placeholder:'{"on_play": [{"op": "draw", "count": 1, "target": "self"}]}'}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 bg-white p-3 rounded border",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Tip:"})," Usa las plantillas de arriba para configuraci\xf3n r\xe1pida, luego personaliza en el editor JSON"]})]})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-yellow-50 p-6 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCDD Texto y Cr\xe9ditos"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["\uD83D\uDCAC Texto de Sabor",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Frase divertida o tem\xe1tica)"})]}),(0,r.jsx)("textarea",{value:v.flavor_text,onChange:e=>j(a=>({...a,flavor_text:e.target.value})),className:"w-full border rounded-md px-3 py-2 h-20 resize-none",placeholder:"Una cita divertida o tem\xe1tica..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:["\uD83C\uDFA8 Artista",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Qui\xe9n cre\xf3 la imagen)"})]}),(0,r.jsx)("input",{type:"text",value:v.artist,onChange:e=>j(a=>({...a,artist:e.target.value})),className:"w-full border rounded-md px-3 py-2",placeholder:"Nombre del Artista"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4 bg-purple-50 p-6 rounded-lg border",children:[(0,r.jsx)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:"\uD83D\uDCCA Configuraci\xf3n de Distribuci\xf3n"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:["✅ Disponibilidad",(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Si aparece en sobres y juegos)"})]}),(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:v.is_active,onChange:e=>j(a=>({...a,is_active:e.target.checked})),className:"rounded"}),(0,r.jsx)("span",{className:"text-sm",children:"La carta est\xe1 activa (aparece en sobres y juegos)"})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"\uD83D\uDCE6 Informaci\xf3n de Sobres"}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,r.jsxs)("p",{children:["• Esta carta aparecer\xe1 en sobres de ",(0,r.jsx)("strong",{children:(null===(c=D.find(e=>e.id===v.set_id))||void 0===c?void 0:c.name)||"colecci\xf3n seleccionada"})]}),(0,r.jsxs)("p",{children:["• Rareza: ",(0,r.jsx)("strong",{children:(null===(m=N.find(e=>e.id===v.rarity_id))||void 0===m?void 0:m.display_name)||"Desconocida"})]}),(0,r.jsxs)("p",{children:["• Probabilidad aproximada: ",W(null===(x=N.find(e=>e.id===v.rarity_id))||void 0===x?void 0:x.code)]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"\uD83D\uDE80 Acciones R\xe1pidas (Despu\xe9s de Guardar)"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[(0,r.jsxs)("div",{className:"p-3 border rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-1",children:"\uD83C\uDF81"}),(0,r.jsx)("div",{className:"text-xs",children:"Dar a Usuarios"})]}),(0,r.jsxs)("div",{className:"p-3 border rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-1",children:"\uD83D\uDCE6"}),(0,r.jsx)("div",{className:"text-xs",children:"A\xf1adir a Sobres"})]}),(0,r.jsxs)("div",{className:"p-3 border rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-1",children:"\uD83C\uDFD7️"}),(0,r.jsx)("div",{className:"text-xs",children:"Crear Mazo"})]}),(0,r.jsxs)("div",{className:"p-3 border rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-1",children:"\uD83D\uDD27"}),(0,r.jsx)("div",{className:"text-xs",children:"Probar Efectos"})]})]})]})]}),C.length>0&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-red-800 mb-2",children:"⚠️ Errores:"}),(0,r.jsx)("ul",{className:"text-red-700 text-sm space-y-1",children:C.map((e,a)=>(0,r.jsxs)("li",{children:["• ",e]},a))})]}),(0,r.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,r.jsx)(i.z,{onClick:J,disabled:S,className:"flex-1 text-lg py-3",children:S?"⏳ Guardando...":b?"\uD83D\uDCBE Actualizar Carta":"\uD83D\uDE80 Crear Carta"}),(0,r.jsx)(i.z,{onClick:y||(()=>f.back()),variant:"outline",disabled:S,className:"px-8 py-3",children:"❌ Cancelar"})]})]})]})})}},2381:function(e,a,t){t.d(a,{z:function(){return d}});var r=t(7437),s=t(2265),l=t(5293),i=t(535),n=t(3448);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,a)=>{let{className:t,variant:s,size:i,asChild:d=!1,...c}=e,m=d?l.g7:"button";return(0,r.jsx)(m,{className:(0,n.cn)(o({variant:s,size:i,className:t})),ref:a,...c})});d.displayName="Button"},9820:function(e,a,t){t.d(a,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return o}});var r=t(7437),s=t(2265),l=t(3448);let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});i.displayName="Card";let n=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...s})});n.displayName="CardHeader";let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("h3",{ref:a,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("p",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},6634:function(e,a,t){t.d(a,{OQ:function(){return l},w7:function(){return i}});var r=t(1388),s=t(257);let l=(0,r.createBrowserClient)(s.env.NEXT_PUBLIC_SUPABASE_URL,s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY),i=async()=>{let{error:e}=await l.auth.signOut();return{error:e}}},3448:function(e,a,t){t.d(a,{cn:function(){return l},ew:function(){return d},gw:function(){return c},kg:function(){return o},uf:function(){return i},xG:function(){return n}});var r=t(1994),s=t(3335);function l(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,s.m6)((0,r.W)(a))}function i(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}function n(e){return"".concat(e," moneditas")}function o(e){return({common:"#9ca3af",uncommon:"#10b981",rare:"#3b82f6",mythic:"#f59e0b",land:"#8b5cf6",token:"#6b7280"})[e.toLowerCase()]||"#9ca3af"}function d(e){return e?e.replace(/\{([^}]+)\}/g,"$1").replace(/([A-Z])/g," $1").trim():""}function c(e){return new Promise(a=>setTimeout(a,e))}t(257)}}]);